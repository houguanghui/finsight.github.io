import{w as b,a as d,t}from"./chunk-PVWAREVJ-CaeOwHG_.js";import{c as w,R as P,C as h,S as z,T as I,f as u}from"./index-kAgd77-w.js";import{h as A,D as H}from"./request-CjBmveHj.js";import{T as R,P as L}from"./Table-Bz-N3dAz.js";import{C as c}from"./index-DFyzaV81.js";import{A as j}from"./index-Bs4fN4oH.js";import{S as m,L as S}from"./index-CQDSfuxM.js";import{C as E}from"./index-CybngSer.js";import"./shadow-Dste9fMo.js";import"./index-C6kagqnf.js";import"./omit-_PpgVY5T.js";import"./index-IEvJvc0V.js";import"./button-DY33ZuDq.js";import"./createForOfIteratorHelper-S2aNMrNp.js";import"./index-BLlS64GR.js";import"./index-CRb9OZA9.js";import"./Pagination-BgtA34Dv.js";import"./index-DsuPZzx1.js";import"./EyeOutlined-BeRCIN0Q.js";import"./index-DSKHKlRI.js";import"./index-jC90AlnQ.js";import"./index-_fd0fOh9.js";import"./index-B4RzsnZD.js";import"./Table-4OPVbUbL.js";import"./Tree-CIH8SUTX.js";import"./Input-Baj7Qhn8.js";import"./Input-Bp_RZhWN.js";import"./index-tUNJ2f8S.js";import"./useNotification-CCy-DdaB.js";import"./index-C38gChg6.js";import"./index-CeNonjvE.js";import"./index-DhCLwE81.js";import"./TextArea-CJq9T7-C.js";import"./callSuper-YXcpR1nQ.js";const B="/api/stock-monthly",K={getStockMonthlyData:async(r,n,i)=>await A.get(`${B}/code/${r}/year-month-range`,{startYearMonth:n,endYearMonth:i})},{RangePicker:Y}=H,{Option:O}=w,{Title:V}=R,W=({data:r})=>{const i={data:r.map(a=>({date:a.yearMonth,open:a.open,close:a.close,high:a.high,low:a.low})),xField:"date",yField:["open","close","high","low"],meta:{date:{alias:"日期"},open:{alias:"开盘价",formatter:a=>`¥${(a==null?void 0:a.toFixed(2))||"0.00"}`},close:{alias:"收盘价",formatter:a=>`¥${(a==null?void 0:a.toFixed(2))||"0.00"}`},high:{alias:"最高价",formatter:a=>`¥${(a==null?void 0:a.toFixed(2))||"0.00"}`},low:{alias:"最低价",formatter:a=>`¥${(a==null?void 0:a.toFixed(2))||"0.00"}`}},slider:{start:.1,end:.9},tooltip:{crosshairs:{line:{stroke:"rgba(24, 144, 255, 0.5)",lineWidth:2}}},lineStyle:{lineWidth:2},color:["#1890ff","#52c41a","#faad14","#f5222d"],height:400};return t.jsx(S,{...i})},_=({data:r})=>{const i={data:r.map(a=>({date:a.yearMonth,price:a.close})),xField:"date",yField:"price",xAxis:{type:"time"},meta:{date:{alias:"日期"},price:{alias:"价格",formatter:a=>`¥${(a==null?void 0:a.toFixed(2))||"0.00"}`}},smooth:!0,slider:{start:.1,end:.9},tooltip:{formatter:a=>{var s;return{name:"收盘价",value:`¥${((s=a.price)==null?void 0:s.toFixed(2))||"0.00"}`}}},color:"#1890ff",height:400};return t.jsx(S,{...i})},Z=({data:r})=>{const i={data:r.map(a=>({date:a.yearMonth,volume:a.volume/1e4})),xField:"date",yField:"volume",meta:{date:{alias:"日期"},volume:{alias:"成交量(万手)"}},slider:{start:.1,end:.9},color:"#52c41a",height:400};return t.jsx(E,{...i})},J=()=>{const[r,n]=d.useState(!0),[i,a]=d.useState(null),[s,k]=d.useState([]),[g,F]=d.useState("600519.SH"),[p,C]=d.useState(["2023-01","2023-12"]),D=[{code:"600519.SH",name:"贵州茅台"},{code:"000858.SZ",name:"五粮液"},{code:"601318.SH",name:"中国平安"},{code:"600036.SH",name:"招商银行"},{code:"000333.SZ",name:"美的集团"},{code:"600276.SH",name:"恒瑞医药"}],y=async()=>{n(!0),a(null);try{const[e]=await Promise.all([K.getStockMonthlyData(g,p[0],p[1])]);k(e||[])}catch(e){a(e.message||"获取数据失败")}finally{n(!1)}},$=(e,o)=>{o[0]&&o[1]&&C(o)},v=e=>{F(e)};d.useEffect(()=>{y()},[g,p]);const l=s.length>0?{currentPrice:s[s.length-1].close,change:s[s.length-1].close-s[0].open,changePercent:((s[s.length-1].close-s[0].open)/s[0].open*100).toFixed(2),highest:Math.max(...s.map(e=>e.high)),lowest:Math.min(...s.map(e=>e.low)),avgVolume:(s.reduce((e,o)=>e+o.volume,0)/s.length/1e4).toFixed(0),totalAmount:(s.reduce((e,o)=>e+o.amount,0)/1e8).toFixed(2)}:null,M=[{title:"年月",dataIndex:"yearMonth",key:"yearMonth",width:100,fixed:"left"},{title:"股票代码",dataIndex:"code",key:"code",width:120},{title:"开盘价",dataIndex:"open",key:"open",renderText:e=>`¥${(e==null?void 0:e.toFixed(2))||"0.00"}`,width:100,align:"right",sorter:(e,o)=>e.open-o.open},{title:"最高价",dataIndex:"high",key:"high",renderText:e=>`¥${(e==null?void 0:e.toFixed(2))||"0.00"}`,width:100,align:"right",sorter:(e,o)=>e.high-o.high},{title:"最低价",dataIndex:"low",key:"low",renderText:e=>`¥${(e==null?void 0:e.toFixed(2))||"0.00"}`,width:100,align:"right",sorter:(e,o)=>e.low-o.low},{title:"收盘价",dataIndex:"close",key:"close",renderText:e=>`¥${(e==null?void 0:e.toFixed(2))||"0.00"}`,width:100,align:"right",sorter:(e,o)=>e.close-o.close},{title:"涨跌幅",key:"changePercent",width:100,align:"right",render:(e,o,f)=>{if(f===0)return"-";const x=s[f-1].close,T=((o.close-x)/x*100).toFixed(2);return t.jsxs("span",{style:{color:o.close>=x?"#3f8600":"#cf1322"},children:[o.close>=x?"+":"",T,"%"]})}},{title:"成交量(万手)",dataIndex:"volume",key:"volume",renderText:e=>`${(e/1e4).toFixed(0)||"0"}`,width:120,align:"right",sorter:(e,o)=>e.volume-o.volume},{title:"成交额(亿元)",dataIndex:"amount",key:"amount",renderText:e=>`${(e/1e8).toFixed(2)||"0.00"}`,width:120,align:"right",sorter:(e,o)=>e.amount-o.amount},{title:"调整标志",dataIndex:"adjustflag",key:"adjustflag",width:80,align:"center"}];return t.jsx("div",{style:{padding:"24px",minHeight:"100vh"},children:t.jsxs(c,{title:t.jsxs("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",gap:"16px"},children:[t.jsx(V,{level:3,style:{margin:0},children:"股票月度数据分析"}),t.jsxs("div",{style:{display:"flex",gap:"16px",marginLeft:"auto"},children:[t.jsx(w,{value:g,onChange:v,style:{width:180},size:"large",loading:r,children:D.map(e=>t.jsxs(O,{value:e.code,children:[e.name," (",e.code,")"]},e.code))}),t.jsx(Y,{picker:"month",onChange:$,value:[u(p[0]),u(p[1])],size:"large",disabled:r})]})]}),variant:"borderless",style:{boxShadow:"0 4px 12px rgba(0, 0, 0, 0.1)"},extra:t.jsx("div",{style:{display:"flex",gap:"8px"},children:t.jsxs("span",{children:["数据更新时间: ",u().format("YYYY-MM-DD HH:mm")]})}),children:[i&&t.jsx(j,{message:"错误",description:i,type:"error",showIcon:!0,style:{marginBottom:24},closable:!0,onClose:()=>a(null)}),l&&!r&&t.jsxs(P,{gutter:16,style:{marginBottom:24},children:[t.jsx(h,{xs:12,sm:8,md:4,children:t.jsx(c,{size:"small",children:t.jsx(m,{title:"当前价格",value:l.currentPrice,precision:2,prefix:"¥",valueStyle:{color:"#3f8600"}})})}),t.jsx(h,{xs:12,sm:8,md:4,children:t.jsx(c,{size:"small",children:t.jsx(m,{title:"涨跌额",value:Math.abs(l.change),precision:2,prefix:l.change>=0?"+¥":"-¥",valueStyle:{color:l.change>=0?"#3f8600":"#cf1322"}})})}),t.jsx(h,{xs:12,sm:8,md:4,children:t.jsx(c,{size:"small",children:t.jsx(m,{title:"涨跌幅",value:l.changePercent,precision:2,suffix:"%",valueStyle:{color:Number(l.changePercent)>=0?"#3f8600":"#cf1322"}})})}),t.jsx(h,{xs:12,sm:8,md:4,children:t.jsx(c,{size:"small",children:t.jsx(m,{title:"最高价",value:l.highest,precision:2,prefix:"¥"})})}),t.jsx(h,{xs:12,sm:8,md:4,children:t.jsx(c,{size:"small",children:t.jsx(m,{title:"最低价",value:l.lowest,precision:2,prefix:"¥"})})}),t.jsx(h,{xs:12,sm:8,md:4,children:t.jsx(c,{size:"small",children:t.jsx(m,{title:"平均成交量",value:l.avgVolume,suffix:"万手"})})})]}),r?t.jsxs("div",{style:{textAlign:"center",padding:40},children:[t.jsx(z,{size:"large"}),t.jsx("div",{style:{marginTop:16},children:"分时数据加载中..."})]}):s.length>0?t.jsx(I,{defaultActiveKey:"1",type:"card",size:"large",items:[{key:"1",label:"K线图",children:t.jsx(W,{data:s})},{key:"2",label:"价格走势",children:t.jsx(_,{data:s})},{key:"3",label:"成交量",children:t.jsx(Z,{data:s})},{key:"4",label:"数据表格",children:t.jsx(L,{columns:M,dataSource:s,rowKey:e=>`${e.code}-${e.yearMonth}`,pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0,showTotal:(e,o)=>`第 ${o[0]}-${o[1]} 条，共 ${e} 条数据`},scroll:{x:1e3},search:!1,options:{density:!0,fullScreen:!0,reload:()=>y(),setting:!0},toolBarRender:!1,dateFormatter:"string",size:"middle"})}]}):t.jsx("div",{style:{textAlign:"center",padding:"50px"},children:t.jsx(j,{message:"暂无数据",description:"请选择其他时间范围或股票代码",type:"info",showIcon:!0})})]})})},Me=b(J);export{Me as default};
