import{w as W,a as l,t}from"./chunk-PVWAREVJ-CaeOwHG_.js";import{h as y}from"./request-CjBmveHj.js";import{T as J,P as K}from"./Table-Bz-N3dAz.js";import{c as M,S as Q,R as A,C as s}from"./index-kAgd77-w.js";import{A as q}from"./index-Bs4fN4oH.js";import{P as d}from"./index-BLlS64GR.js";import{C as h}from"./index-DFyzaV81.js";import{m as N,S as m,L as b}from"./index-CQDSfuxM.js";import{D as V}from"./index-CeNonjvE.js";import{P as X}from"./index-DPP3BEpb.js";import{C as _}from"./index-CybngSer.js";import{a as D}from"./index-CVy4ob4l.js";import"./createForOfIteratorHelper-S2aNMrNp.js";import"./shadow-Dste9fMo.js";import"./omit-_PpgVY5T.js";import"./index-IEvJvc0V.js";import"./index-C6kagqnf.js";import"./button-DY33ZuDq.js";import"./index-DsuPZzx1.js";import"./Pagination-BgtA34Dv.js";import"./index-jC90AlnQ.js";import"./index-_fd0fOh9.js";import"./index-B4RzsnZD.js";import"./Table-4OPVbUbL.js";import"./Tree-CIH8SUTX.js";import"./Input-Baj7Qhn8.js";import"./Input-Bp_RZhWN.js";import"./index-tUNJ2f8S.js";import"./useNotification-CCy-DdaB.js";import"./index-CRb9OZA9.js";import"./index-C38gChg6.js";import"./index-DhCLwE81.js";import"./EyeOutlined-BeRCIN0Q.js";import"./TextArea-CJq9T7-C.js";import"./callSuper-YXcpR1nQ.js";import"./index-DSKHKlRI.js";import"./AntdIcon-Dmy0igr9.js";var ee=N("Gauge");const f={async getProfitHistory(i){return y.get(`/api/profit-analysis/history/${encodeURIComponent(i)}`)},async analyzeGrowthTrend(i,u=5){return y.get(`/api/profit-analysis/growth/${encodeURIComponent(i)}`,{years:u})},async analyzeProfitability(i){return y.get(`/api/profit-analysis/profitability/${encodeURIComponent(i)}`)}},{Text:g}=J,{Option:te}=M,re=()=>{var F,I,w,P;const[i,u]=l.useState("600519.SH"),[a,T]=l.useState([]),[j,z]=l.useState([]),[r,$]=l.useState(null),[p,v]=l.useState(!1),[C,S]=l.useState(null),k=[{value:"600519.SH",label:"贵州茅台"},{value:"000858.SZ",label:"五粮液"},{value:"601318.SH",label:"中国平安"},{value:"000333.SZ",label:"美的集团"}];l.useEffect(()=>{R()},[i]);const R=async()=>{v(!0),S(null);try{const[e,o,x]=await Promise.all([f.getProfitHistory(i),f.analyzeGrowthTrend(i,5),f.analyzeProfitability(i)]);T(e),z(o),$(x)}catch(e){console.error("加载数据失败:",e),S(e instanceof Error?e.message:"数据加载失败")}finally{v(!1)}},c=e=>e?(e/1e8).toFixed(2):"0.00",n=e=>e?e.toFixed(2):"0.00",B={height:300,padding:"auto",xField:"reportDate",yField:"value",seriesField:"type",xAxis:{title:{text:"报告期"},label:{formatter:e=>e.slice(0,7)}},yAxis:{title:{text:"金额(亿元)"},label:{formatter:e=>`${(e/1e8).toFixed(0)}`}},legend:{position:"top"},smooth:!0,animation:{appear:{animation:"wave-in",duration:1e3}}},E={height:300,padding:"auto",xField:"reportDate",yField:"value",seriesField:"type",xAxis:{title:{text:"报告期"},label:{formatter:e=>e.slice(0,7)}},yAxis:{title:{text:"比率(%)"},label:{formatter:e=>`${e.toFixed(1)}%`}},legend:{position:"top"},smooth:!0},Y={height:300,padding:"auto",xField:"year",yField:"value",seriesField:"type",isGroup:!0,xAxis:{title:{text:"年份"}},yAxis:{title:{text:"增长率(%)"},label:{formatter:e=>`${e.toFixed(1)}%`}},legend:{position:"top"}},G={height:300,data:r!=null&&r.expenseRatios?Object.entries(r.expenseRatios).map(([e,o])=>({type:e.replace("Ratio","").replace(/([A-Z])/g," $1"),value:Math.abs(o)})):[],angleField:"value",colorField:"type",labels:[{text:({type:e,value:o})=>`${o}%`,style:{fontSize:12,fontWeight:"bold",fill:"#333",textAlign:"center"},position:"inside",connector:!1}],tooltip:{items:[{field:"value",name:"占比",valueFormatter:e=>`${e}%`}]},legend:{color:{title:!1,position:"right",rowPadding:3}},interactions:[{type:"element-active"}]},H={height:300,autoFit:!0,data:{target:(r==null?void 0:r.profitabilityScore)||0,total:100,name:"盈利能力评分",thresholds:[33.33,66.66,100]},scale:{color:{range:["#F4664A","#FAAD14","#30BF78"]}},style:{textContent:(e,o)=>{var x;return`得分：${((x=r==null?void 0:r.profitabilityScore)==null?void 0:x.toFixed(1))||0}
毛利率: ${n(r==null?void 0:r.grossMargin)}%
净利率: ${n(r==null?void 0:r.netMargin)}%`},textY:230,textFontSize:24,fontWeight:"bold",textAlign:"center",textBaseline:"middle",fill:"#333"}},L=a.slice(0,8).reverse().flatMap(e=>[{reportDate:e.reportDate,value:e.operateIncome||0,type:"营业收入"},{reportDate:e.reportDate,value:e.netprofit||0,type:"净利润"}]),O=a.slice(0,8).reverse().flatMap(e=>[{reportDate:e.reportDate,value:e.grossMargin||0,type:"毛利率"},{reportDate:e.reportDate,value:e.netMargin||0,type:"净利率"}]),Z=j.flatMap(e=>[{year:e.year,value:e.revenueGrowth||0,type:"营收增长率"},{year:e.year,value:e.profitGrowth||0,type:"利润增长率"}]),U=r!=null&&r.expenseRatios?Object.entries(r.expenseRatios).map(([e,o])=>({name:e.replace("Ratio","").replace(/([A-Z])/g," $1"),value:Math.abs(o)})):[];return p?t.jsx(D,{children:t.jsxs("div",{style:{textAlign:"center",padding:"100px"},children:[t.jsx(Q,{size:"large"}),t.jsx("div",{style:{marginTop:16},children:"数据加载中..."})]})}):t.jsxs(D,{children:[C&&t.jsx(q,{message:"加载错误",description:C,type:"error",showIcon:!0,closable:!0,style:{marginBottom:16}}),t.jsxs(d,{title:t.jsxs("div",{style:{display:"flex",alignItems:"center"},children:[t.jsx("span",{children:"利润表分析"}),t.jsx(M,{value:i,onChange:u,style:{width:200,marginLeft:16},loading:p,children:k.map(e=>t.jsx(te,{value:e.value,children:e.label},e.value))})]}),loading:p,children:[a.length>0&&t.jsxs(t.Fragment,{children:[t.jsxs(A,{gutter:16,style:{marginBottom:24},children:[t.jsx(s,{xs:12,sm:6,children:t.jsx(h,{size:"small",children:t.jsx(m,{title:"营业收入",value:c((F=a[0])==null?void 0:F.operateIncome),precision:2,suffix:"亿元",valueStyle:{color:"#1890ff"}})})}),t.jsx(s,{xs:12,sm:6,children:t.jsx(h,{size:"small",children:t.jsx(m,{title:"净利润",value:c((I=a[0])==null?void 0:I.netprofit),precision:2,suffix:"亿元",valueStyle:{color:"#52c41a"}})})}),t.jsx(s,{xs:12,sm:6,children:t.jsx(h,{size:"small",children:t.jsx(m,{title:"毛利率",value:n((w=a[0])==null?void 0:w.grossMargin),precision:2,suffix:"%",valueStyle:{color:"#fa8c16"}})})}),t.jsx(s,{xs:12,sm:6,children:t.jsx(h,{size:"small",children:t.jsx(m,{title:"净利率",value:n((P=a[0])==null?void 0:P.netMargin),precision:2,suffix:"%",valueStyle:{color:"#f5222d"}})})})]}),t.jsx(V,{}),t.jsxs(A,{gutter:[16,16],children:[t.jsx(s,{xs:24,lg:12,children:t.jsx(d,{title:"收入利润趋势",headerBordered:!0,children:t.jsx(b,{...B,data:L})})}),t.jsx(s,{xs:24,lg:12,children:t.jsx(d,{title:"盈利能力趋势",headerBordered:!0,children:t.jsx(b,{...E,data:O})})}),t.jsx(s,{xs:24,lg:8,children:t.jsx(d,{title:"费用结构分析",headerBordered:!0,children:U.length>0?t.jsx(X,{...G}):t.jsx("div",{style:{height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(g,{type:"secondary",children:"暂无费用数据"})})})}),t.jsx(s,{xs:24,lg:8,children:t.jsx(d,{title:"增长指标分析",headerBordered:!0,children:j.length>0?t.jsx(_,{...Y,data:Z}):t.jsx("div",{style:{height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(g,{type:"secondary",children:"暂无增长数据"})})})}),t.jsx(s,{xs:24,lg:8,children:t.jsx(d,{title:"盈利能力评分",headerBordered:!0,children:r?t.jsx("div",{style:{textAlign:"center",position:"relative"},children:t.jsx(ee,{...H})}):t.jsx("div",{style:{height:300,display:"flex",alignItems:"center",justifyContent:"center"},children:t.jsx(g,{type:"secondary",children:"暂无评分数据"})})})})]}),t.jsx(d,{title:"详细数据",style:{marginTop:24},headerBordered:!0,children:t.jsx(K,{dataSource:a,rowKey:"reportDate",pagination:{pageSize:10,showSizeChanger:!0,showQuickJumper:!0},search:!1,scroll:{x:800},columns:[{title:"报告期",dataIndex:"reportDate",key:"reportDate",width:120,fixed:"left"},{title:"营业收入(亿元)",dataIndex:"operateIncome",key:"operateIncome",renderText:e=>c(e),sorter:(e,o)=>(e.operateIncome||0)-(o.operateIncome||0)},{title:"营收增长率(%)",dataIndex:"operateIncomeYoy",key:"operateIncomeYoy",renderText:e=>n(e),sorter:(e,o)=>(e.operateIncomeYoy||0)-(o.operateIncomeYoy||0)},{title:"净利润(亿元)",dataIndex:"netprofit",key:"netprofit",renderText:e=>c(e),sorter:(e,o)=>(e.netprofit||0)-(o.netprofit||0)},{title:"净利润增长率(%)",dataIndex:"netprofitYoy",key:"netprofitYoy",renderText:e=>n(e),sorter:(e,o)=>(e.netprofitYoy||0)-(o.netprofitYoy||0)},{title:"毛利率(%)",dataIndex:"grossMargin",key:"grossMargin",renderText:e=>n(e),sorter:(e,o)=>(e.grossMargin||0)-(o.grossMargin||0)},{title:"每股收益(元)",dataIndex:"basicEps",key:"basicEps",renderText:e=>(e==null?void 0:e.toFixed(2))||"-",sorter:(e,o)=>(e.basicEps||0)-(o.basicEps||0)}]})})]}),a.length===0&&!p&&t.jsx("div",{style:{textAlign:"center",padding:"40px"},children:t.jsx(g,{type:"secondary",children:"暂无数据，请选择其他股票或检查数据源"})})]})]})},He=W(re);export{He as default};
